<div class="event-container">
  <!-- Loading indicator -->
  <div *ngIf="isLoading" class="loading-spinner">
    <div class="spinner" role="status"></div>
    <span>Chargement des événements...</span>
  </div>

  <!-- Content when loaded -->
  <div *ngIf="!isLoading" class="events-content">
    <h2 class="section-title">Événements à venir</h2>

    <div *ngIf="events.length === 0" class="no-events">
      <i class="bi bi-calendar-x"></i>
      Aucun événement à afficher pour le moment.
    </div>

    <div class="events-grid">
      <div *ngFor="let event of events" class="event-card">
        <img *ngIf="event.image" [src]="'data:image/png;base64,' + event.image" class="event-image" alt="{{event.name}}" loading="lazy">

        <div class="event-content">
          <h3 class="event-title">{{event.name}}</h3>

          <div class="event-meta">
            <p>
              <i class="bi bi-calendar-event"></i>
              {{formatDate(event.start_date)}}
              <span *ngIf="event.end_date"> - {{formatDate(event.end_date)}}</span>
            </p>
            <p *ngIf="event.location">
              <i class="bi bi-geo-alt"></i> {{event.location}}
            </p>
          </div>

          <div class="event-description-container" (click)="toggleDescription(event.id)">
            <p class="event-description" [class.expanded]="isExpanded(event.id)">
              {{ isExpanded(event.id) ? event.description : getTruncatedDescription(event.description) }}
            </p>
            <button *ngIf="event.description && event.description.length > maxDescriptionLength" 
                    class="read-more-btn">
              {{ isExpanded(event.id) ? 'Voir moins' : 'Voir plus...' }}
            </button>
          </div>
          
          <div class="event-actions">
            <button *ngIf="hasValidLink(event)" class="register-button" 
                    (click)="openRegistrationLink(event.lien!)"
                    [disabled]="!isValidUrl(event.lien!)">
              <i class="bi bi-pencil-square"></i> S'inscrire
            </button>
            <div *ngIf="!hasValidLink(event)" class="no.lien">
              <i class="bi bi-exclamation-circle"></i> 
              <span *ngIf="!event.lien">Aucun lien d'inscription fourni</span>
              <span *ngIf="event.lien">Lien d'inscription invalide</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>